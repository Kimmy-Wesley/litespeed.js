<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Litespeed.js</title>
        <link rel="icon" type="image/png" href="/favicon.png">
        <link href="/styles/default.css" rel="stylesheet" />
        <link href="/styles/androidstudio.css" rel="stylesheet" />
        <meta name="description" content="Sample Litespeed.js application">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />

        <style>
            [data-ls-placeholder] {
                background: red;
            }
        </style>
    </head>

    <body data-ls-init data-first-from-server="false">
        <div style="margin: 50px; padding: 50px; border-radius: 50px; border: solid 1px #f1f1f1;">
            <h1 data-ls-bind="tasks.title">---</h1>

            <input type="text" data-ls-bind="tasks.title" title="">

            <form data-tasks-add>
                <h2>Add New Task</h2>
                <input name="task" type="text" autocomplete="off">
                <button type="submit">Submit</button>
            </form>

            <hr />

            <ul data-ls-loop="tasks.list" data-ls-as="task">
                <li data-ls-attr="class=completed-{{task.completed}}">
                    <label>
                        <input type="text" data-ls-bind="task.content" title="">
                        <input class="toggle" type="checkbox" data-ls-bind="task.completed">
                        <span data-ls-bind="task.content"></span> <button type="button" data-tasks-remove="{{task.id}}">Delete</button>
                    </label>
                </li>
            </ul>


            <label>
                <select data-ls-loop="tasks.list" data-ls-as="task">
                    <option data-ls-attr="value=completed-{{task.completed}}" data-ls-bind="task.content"></option>
                </select>
            </label>

            <hr />

            <strong><span data-ls-bind="tasks.list.length"></span> Items</strong>

            <hr />

            add delete button, mark as complete, mark all as complete, apply filters
        </div>
        <header class="header">
            <div data-ls-attr="x=1,y,z"></div>

            <nav>
                <ul>
                    <li>
                        <a href="/">Home</a>
                    </li>
                    <li>
                        <a href="/article.html">Blog</a>
                    </li>
                </ul>
            </nav>

            <a href="/" title="Litespeed.js" alt="Litespeed.js">
                <img src="/images/litespeed.png" alt="Litespeed.js" title="Litespeed.js" class="logo" height="70" />
            </a>
        </header>

        <main data-ls-scope="" style="min-height: 500px">
            <div class="loader"></div>
        </main>

        <hr />

        <footer>
            Â© 2015-2016. Code licensed under an MIT License
        </footer>

        <script>
            (function (window) {
                "use strict";

                document.addEventListener("DOMContentLoaded", function() {
                    let head      = document.getElementsByTagName('head')[0];
                    let script    = document.createElement('script');
                    script.type   = 'text/javascript';
                    script.async  = true;
                    script.src    = 'scripts/litespeed.js';

                    script.onload = function() {
                        window.Demo = app('v1.0.0'); // Init app and set cache buster value

                        let state = window.Demo.container.get('state');

                        state
                            .add('/', {
                                template: '/pages/index.html'
                            })
                            .add('/article.html', {
                                template: '/pages/article.html'
                            })
                        ;

                        window.Demo.container
                            .set('tasks', function () {
                                return {
                                    title: 'Task Title',
                                    list: [
                                        {
                                            id: 0,
                                            completed: true,
                                            show: true,
                                            content: 'This is just my first task',
                                        },
                                        {
                                            id: 1,
                                            completed: false,
                                            show: true,
                                            content: 'This is just another test adding a second task',
                                        },
                                        {
                                            id: 2,
                                            completed: false,
                                            show: true,
                                            content: 'What do you think about this test',
                                        },
                                    ],
                                    add: function (task) {
                                        task.id = this.list.length;
                                        this.list.push(task);
                                    },
                                    remove: function (key) {
                                        this.list = this.list.filter(function (x) {
                                            return x.id != key;
                                        })
                                    },
                                }
                            }, true)
                        ;

                        window.Demo.container.get('view')
                            .add({
                                selector: 'data-tasks-add',
                                controller: function(element, tasks) {
                                    element.addEventListener('submit', function () {
                                        event.preventDefault();

                                        tasks.add({
                                            completed: false,
                                            show: true,
                                            content: element.task.value
                                        });

                                        element.reset();
                                    });
                                }
                            })
                            .add({
                                selector: 'data-tasks-remove',
                                controller: function(element, tasks, expression) {
                                    let id = expression.parse(element.dataset['tasksRemove']);

                                    element.addEventListener('click', function () {
                                        tasks.remove(id);
                                    });
                                }
                            });

                        window.Demo.run(window);
                    };

                    head.appendChild(script);
                });

            }(window));

        </script>
    </body>
</html>